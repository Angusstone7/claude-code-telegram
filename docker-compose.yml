version: '3.8'


services:
  claude-bot:
    build: .
    container_name: claude_agent
    restart: always
    env_file: .env
    volumes:
      # Пробрасываем приватный ключ внутрь контейнера (только для чтения)
      - ./bot_key:/app/bot_key:ro
      # Persistent storage for database and logs
      - ./data:/app/data
      - ./logs:/app/logs
      # Projects directory - persists across container rebuilds
      - ./projects:/root/projects
      # Claude Code sessions - preserves conversation history and context compression
      - ./claude_sessions:/root/.claude
    # Этот хак позволяет контейнеру видеть хост по адресу host.docker.internal
    extra_hosts:
      - "host.docker.internal:host-gateway"
